{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/nirg/Desktop/spring/cuoponProject/cuoponProject/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/nirg/Desktop/spring/cuoponProject/cuoponProject/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/nirg/Desktop/spring/cuoponProject/cuoponProject/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useCallback}from'react';import'../Design/App.css';import{HomeCustomer}from'./Customer/HomeCustomer';import{HomeCompany}from'./Company/HomeCompany';import HomeAdmin from'./Admin/HomeAdmin';import{fetchCompanyIdByEmail,fetchCustomerIdByEmail}from'../services/ServerService';import{UserType}from'../Entitis.type';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(UserType.ADMINISTRATOR),_useState6=_slicedToArray(_useState5,2),userType=_useState6[0],setUserType=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),loginToken=_useState8[0],setLoginToken=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),logId=_useState10[0],setLogId=_useState10[1];var login=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();// prevent page refresh\n_context.next=3;return fetch('http://localhost:8080/login',{headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password,userType:userType}),mode:'cors',method:'POST'}).then(function(data){return data.text();}).then(function(token){return setLoginToken(token);}).catch(function(error){return console.log(error);});case 3:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[loginToken]);var userHandler=function userHandler(){if(loginToken!==''&&userType==='ADMINISTRATOR'){return/*#__PURE__*/_jsx(HomeAdmin,{token:loginToken});}if(loginToken!==''&&userType==='CUSTOMER'){// Use the fetchCustomerIdByEmail function to get the customer ID\nfetchCustomerIdByEmail(email).then(function(id){return setLogId(id);});return/*#__PURE__*/_jsx(HomeCustomer,{token:loginToken,id:logId});}if(loginToken!==''&&userType==='COMPANY'){fetchCompanyIdByEmail(email).then(function(id){return setLogId(id);});return/*#__PURE__*/_jsx(HomeCompany,{token:loginToken,id:logId});}// handle case where token is not received\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{children:\"Login unsuccessful. Please check your email and password and try again.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setLoginToken('');},children:\"Back to login\"})]});};return/*#__PURE__*/_jsx(\"div\",{className:\"login\",children:loginToken===''?/*#__PURE__*/_jsxs(\"form\",{onSubmit:login,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:function onChange(event){return setEmail(event.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Password: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:function onChange(event){return setPassword(event.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"UserType:\"}),/*#__PURE__*/_jsx(\"select\",{value:userType,onChange:function onChange(event){return setUserType(event.target.value);},children:Object.values(UserType).map(function(userType){return/*#__PURE__*/_jsx(\"option\",{value:userType,children:userType},userType);})}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Login\"})]}):userHandler()});}export default Login;","map":{"version":3,"names":["useState","useCallback","HomeCustomer","HomeCompany","HomeAdmin","fetchCompanyIdByEmail","fetchCustomerIdByEmail","UserType","jsx","_jsx","jsxs","_jsxs","Login","_useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","_useState5","ADMINISTRATOR","_useState6","userType","setUserType","_useState7","_useState8","loginToken","setLoginToken","_useState9","_useState10","logId","setLogId","login","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","wrap","_callee$","_context","prev","next","preventDefault","fetch","headers","body","JSON","stringify","mode","method","then","data","text","token","catch","error","console","log","stop","_x","apply","arguments","userHandler","id","children","onClick","className","onSubmit","type","value","onChange","target","Object","values","map"],"sources":["C:/Users/nirg/Desktop/spring/cuoponProject/cuoponProject/client/src/Components/Login.tsx"],"sourcesContent":["import { useState, useCallback, FormEvent, useContext } from 'react';\nimport '../Design/App.css'\nimport { HomeCustomer } from './Customer/HomeCustomer';\nimport { HomeCompany } from './Company/HomeCompany';\nimport HomeAdmin from './Admin/HomeAdmin';\nimport { fetchCompanyIdByEmail, fetchCustomerIdByEmail } from '../services/ServerService';\nimport { UserType } from '../Entitis.type';\n\n\nfunction Login(): JSX.Element {\n\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [userType, setUserType] = useState<UserType>(UserType.ADMINISTRATOR);\n  const [ loginToken, setLoginToken ]= useState('')\n  const [logId, setLogId] = useState<number | undefined>();\n\n  const login = useCallback(async (event: FormEvent<HTMLFormElement>): Promise<void> => {\n    event.preventDefault(); // prevent page refresh\n    await fetch('http://localhost:8080/login', {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        email: email,\n        password: password,\n        userType: userType,\n      }),\n      mode: 'cors',\n      method: 'POST',\n    })\n      .then((data) => data.text())\n      .then((token) => setLoginToken(token))\n      .catch((error) => console.log(error));\n  }, [loginToken]);\n\n  const userHandler = () => {\n    if (loginToken !== '' && userType === 'ADMINISTRATOR') {\n      return (\n        <HomeAdmin token={loginToken} />\n      )\n    }\n\n    if (loginToken !== '' && userType === 'CUSTOMER') {\n      // Use the fetchCustomerIdByEmail function to get the customer ID\n      fetchCustomerIdByEmail(email).then(id => setLogId(id));\n      return (<HomeCustomer token={loginToken} id={logId} />)\n    }\n\n    if (loginToken !== '' && userType === 'COMPANY') {\n      fetchCompanyIdByEmail(email).then(id => setLogId(id));\n      return <HomeCompany token={loginToken} id={logId} />;\n    }\n\n    // handle case where token is not received\n    return (\n      <div>\n        <p>Login unsuccessful. Please check your email and password and try again.</p>\n        <button onClick={() => setLoginToken('')}>Back to login</button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"login\">\n      {loginToken === '' ? <form onSubmit={login}>\n        <label>Email: </label>\n        <input type=\"email\" value={email} onChange={(event) => setEmail(event.target.value)} /><br />\n        <label>Password: </label>\n        <input type=\"password\" value={password} onChange={(event) => setPassword(event.target.value)} /><br />\n        <label>UserType:</label>\n        <select value={userType} onChange={(event) => setUserType(event.target.value as UserType)}>\n          {Object.values(UserType).map((userType) => (\n            <option key={userType} value={userType}>\n              {userType}\n            </option>\n          ))}\n        </select>\n        <button type=\"submit\">Login</button>\n      </form>\n        :\n        userHandler()\n      }\n    </div>\n  );\n}\n\nexport default Login;\n\n\n\n\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}